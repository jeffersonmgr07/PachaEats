
<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Pacha Wok ‚Ä¢ Pacha Eats</title>

  <style>
    :root{
      --text:#111827;
      --muted:#6b7280;

      --brand:#e21f0c;      /* header/footer */
      --bg:#f5ebdc;         /* fondo */
      --heroArrow:#d62300;  /* botones */
      --shadow: 0 14px 30px rgba(17,24,39,.10);
      --shadow2: 0 10px 22px rgba(17,24,39,.09);
      --shadow3: 0 18px 40px rgba(17,24,39,.14);

      --radiusHeader: 48px;
      --radiusPill: 999px;
      --radiusCard: 18px;

      --max: 1180px;
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Noto Sans", "Helvetica Neue", sans-serif;
      background:var(--bg);
      color:var(--text);
    }
    a{color:inherit;text-decoration:none}
    img{max-width:100%;display:block}
    button,input,select{font:inherit}
    .container{max-width:var(--max); margin:0 auto; padding:0 14px;}
    .sr-only{
      position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0;
    }

    /* ================= HEADER ================= */
    header{
      position:sticky;
      top:0;
      z-index:60;
      background: rgba(245,235,220,.88);
      backdrop-filter: blur(8px);
      border-bottom: 1px solid rgba(0,0,0,.06);
      transition: transform .22s ease;
      will-change: transform;
    }
    header.is-hidden{ transform: translateY(-110%); }

    .header-wrap{padding:4px 0 4px;}
    .header-bar{
      background: var(--brand);
      border-radius: var(--radiusHeader);
      box-shadow: var(--shadow3);
      padding:4px 4px;
      display:flex;
      align-items:center;
      gap:10px;
      overflow:hidden;
      position:relative;
    }
    .header-bar::after{
      content:"";
      position:absolute; inset:-2px;
      background:
        radial-gradient(120px 120px at 14% 0%, rgba(255,255,255,.16), transparent 60%),
        radial-gradient(160px 160px at 82% 20%, rgba(255,255,255,.12), transparent 60%),
        radial-gradient(220px 220px at 50% 120%, rgba(0,0,0,.14), transparent 60%);
      pointer-events:none;
      mix-blend-mode: screen;
    }

    .logo{
      width:36px; height:36px;
      border-radius:0;
      display:grid; place-items:center;
      overflow:visible;
      flex:0 0 auto;
      background: transparent;
      border:none;
      box-shadow:none;
      z-index:1;
      margin-bottom: 7px;
      margin-left: 14px;
      margin-top: 1px;
      margin-right: 0px;
    }
    .logo img{width:100%; height:100%; object-fit:contain; padding:0;}

    .search{
      display:flex;
      align-items:center;
      gap:10px;
      background:#fff;
      border-radius: var(--radiusPill);
      padding:11px 12px;
      flex: 1 1 360px;
      min-width: 200px;
      box-shadow: var(--shadow2);
      z-index:1;
      border:1px solid rgba(229,231,235,.85);
    }
    .search input{
      border:none;
      outline:none;
      width:100%;
      min-width:0;
      font-size:14px;
    }
    .search input::placeholder{color:#9ca3af}

    .info-block{
      color:#fff;
      display:flex;
      align-items:center;
      gap:10px;
      padding:8px 10px;
      border-radius:16px;
      background: rgba(255,255,255,.10);
      border:1px solid rgba(255,255,255,.18);
      white-space:nowrap;
      flex:0 0 auto;
      z-index:1;
    }
    .info-block .icon{width:28px; height:28px; display:grid; place-items:center; flex:0 0 auto;}
    .info-block.delivery .icon{ width:36px; height:36px; }
    .info-block .lines{display:flex; flex-direction:column; line-height:1.08; gap:2px;}
    .info-block .top{font-weight:950; font-size:13px;}
    .info-block .bottom{font-weight:750; font-size:12px; opacity:.95;}
    .info-block .chev{margin-left:2px; font-weight:900; width:16px; display:grid; place-items:center;}

    .cart-pill{
      display:flex;
      align-items:center;
      gap:10px;
      background:#fff;
      border-radius: var(--radiusPill);
      padding:10px 10px;
      box-shadow: var(--shadow2);
      flex:0 0 auto;
      cursor:pointer;
      border:1px solid rgba(229,231,235,.85);
      z-index:1;
    }
    .cart-pill .total-badge{
      background: var(--brand);
      color:#fff;
      border-radius: 999px;
      padding:7px 10px;
      font-weight:900;
      font-size:12px;
      line-height:1;
      min-width:92px;
      text-align:center;
      box-shadow: 0 12px 22px rgba(226,31,12,.24);
    }

    /* Hover micro */
    button, .btn, a.btn, .product-card, .info-block, .cart-pill {
      transition: transform .18s ease, box-shadow .18s ease, filter .18s ease;
    }
    button:hover, .btn:hover, a.btn:hover, .product-card:hover, .info-block:hover, .cart-pill:hover {
      transform: scale(1.03);
    }

    main{padding: 12px 0 44px;}

    /* ===== Restaurant hero ===== */
    .rest-hero{
      background: rgba(255,255,255,.88);
      border:1px solid rgba(0,0,0,.08);
      border-radius: 22px;
      box-shadow: var(--shadow2);
      overflow:hidden;
    }
    .rest-hero-inner{
      padding: 10px 12px;
      display:flex;
      gap:15px;
      align-items:center;
      flex-wrap:wrap;
      min-height: 0 !important;
    }
    .rest-logo{
      width: 195px;
      height: 150px;
      border-radius: 0;
      background: transparent;
      border: none;
      box-shadow: none;
      display:flex;
      align-items:center;
      justify-content:center;
      overflow: visible;
      flex:0 0 auto;

      position: relative;
      padding-right: 8px;
      margin-right: 8px;
    }
    .rest-logo::after{
      content:"";
      position:absolute;
      right: 0;
      top: 50%;
      height: 70%;
      transform: translateY(-50%);
      width: 1px;
      background: rgba(107,114,128,.25);
    }
    .rest-logo img{width:195px; height:150px; object-fit:contain;}

    .rest-copy{
      display:flex;
      flex-direction:column;
      justify-content:center;
    }
    .rest-copy p{
      margin:1px 0 0;
      color:#374151;
      font-size: 13.5px;
      line-height: 1.35;
    }

    /* ===== Ubicaci√≥n + rating (PRO) ===== */
    .rest-meta{
      display:flex;
      justify-content: flex-start;;
      align-items:center;
      gap:10px;
      flex-wrap:wrap;
      margin-bottom: 6px;
      text-align: left;
    }
    .rest-loc{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:6px 10px;
      border-radius:999px;
      font-weight:950;
      font-size:12px;
      color:#9a3412;
      background: rgba(249,115,22,.12);
      border:1px solid rgba(249,115,22,.35);
      box-shadow: 0 10px 18px rgba(17,24,39,.05);
      width: fit-content;
    }
    .rest-loc .ico{display:grid; place-items:center;}
    .rest-rating{
      border:none;
      background: rgba(255,255,255,.92);
      border:1px solid rgba(0,0,0,.10);
      border-radius:999px;
      padding:6px 10px;
      display:inline-flex;
      align-items:center;
      gap:8px;
      cursor:pointer;
      box-shadow: 0 10px 18px rgba(17,24,39,.05);
    }
    .rest-rating .stars{display:inline-flex; gap:2px; align-items:center;}
    .rest-rating .stars svg{width:14px;height:14px; fill:#f59e0b; display:block;}
    .rest-rating .rating-text{font-size:12px; color:#111827; font-weight:850; white-space:nowrap;}
    .rest-rating .chev{ font-weight:950; color:#6b7280; margin-left:2px; }


    .rest-hours{
      position: relative;
      padding-left: 15px;
      padding-right: 10px;
      margin:1px 10px 1px 10px;
      min-width: 150px;
      display:flex;
      flex-direction: column;
      justify-content: center;
    }
    .rest-hours::before{
      content:"";
      position:absolute;
      left: 0;
      top: 50%;
      height: 150%;
      transform: translateY(-50%);
      width: 1px;
      background: rgba(107,114,128,.25);
    }
    .rest-hours-title{
      font-weight: 950;
      font-size: 13px;
      color: #111827;
      margin-bottom: 1px;
    }
    .rest-hours-time{
      font-size: 13px;
      color: #374151;
      line-height: 1.35;
    }

    /* ===== Estado abierto/cerrado ===== */
    .rest-status{
      display:inline-flex;
      align-items:center;
      gap:8px;
      width: fit-content;
      padding:6px 10px;
      border-radius: 999px;
      font-weight: 950;
      font-size: 12px;
      letter-spacing: .2px;
      margin-bottom: 6px;
      border: 1px solid rgba(0,0,0,.08);
      box-shadow: 0 10px 18px rgba(17,24,39,.06);
    }
    .rest-status::before{
      content:"";
      width:9px;height:9px;
      border-radius:999px;
      background: currentColor;
      box-shadow: 0 0 0 4px rgba(0,0,0,.04);
    }
    .rest-status.open{
      color:#065f46; /* verde */
      background: rgba(16,185,129,.12);
      border-color: rgba(16,185,129,.35);
    }
    .rest-status.closed{
      color:#991b1b; /* rojo */
      background: rgba(239,68,68,.12);
      border-color: rgba(239,68,68,.35);
    }


    /* ===== Tabs ===== */
    .tabs{ margin-top: 12px; position: static; }
    .tabs-inner{
      background: rgba(245,235,220,.92);
      backdrop-filter: blur(8px);
      border-radius: 999px;
      border:1px solid rgba(0,0,0,.08);
      box-shadow: 0 12px 26px rgba(17,24,39,.08);
      padding: 8px;
      display:flex;
      gap:8px;
      overflow:auto;
      scrollbar-width:none;
    }
    .tabs-inner::-webkit-scrollbar{display:none}
    .tab{
      border:none;
      border-radius: 999px;
      padding: 10px 12px;
      background:#fff;
      border:1px solid rgba(0,0,0,.10);
      font-weight: 950;
      font-size: 13px;
      cursor:pointer;
      white-space:nowrap;
    }
    .tab.active{
      background: var(--brand);
      color:#fff;
      border-color: var(--brand);
      box-shadow: 0 14px 22px rgba(226,31,12,.20);
    }

    /* ===== Grid productos ===== */
    .block{ margin-top: 14px; }
    .block-title{
      margin: 18px 0 10px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
    }
    .block-title h3{ margin:0; font-size: 18px; font-weight: 950; }
    .block-title small{color: var(--muted); font-weight: 800;}
    .grid{
      display:grid;
      grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
      gap:14px;
    }

    .p-card{
      border-radius: 14px;
      background:#fff;
      border:1px solid rgba(0,0,0,.08);
      box-shadow: var(--shadow2);
      overflow:hidden;
      display:flex;
      flex-direction:column;
      padding: 14px 14px 16px;
      min-height: 250px;
    }
    .p-imgbox{
      height: 120px;
      border-radius: 12px;
      background: #ffffff;
      display:grid;
      place-items:center;
      overflow:hidden;
      border:1px solid rgba(0,0,0,.06);
    }
    .p-imgbox img{
      width:100%;
      height:100%;
      object-fit:contain;
    }
    .p-imgbox .ph{
      width:100%;
      height:100%;
      display:grid;
      place-items:center;
      color:#6b7280;
      font-weight:950;
      font-size:12px;
      background: linear-gradient(180deg, #fff, #fff6ef);
    }
    .p-name{
      margin: 12px 0 0;
      font-weight: 950;
      font-size: 13.5px;
      line-height: 1.15;
      min-height: 34px;
      display:-webkit-box;
      -webkit-line-clamp:2;
      -webkit-box-orient:vertical;
      overflow:hidden;
    }
    .p-desc{
      margin: 8px 0 0;
      color:#4b5563;
      font-size: 12.5px;
      line-height: 1.3;
      display:-webkit-box;
      -webkit-line-clamp:3;
      -webkit-box-orient:vertical;
      overflow:hidden;
      min-height: 48px;
    }
    .p-price{
      margin-top: 10px;
      font-weight: 950;
      font-size: 15px;
      color:#111827;
    }
    .p-actions{
      margin-top:auto;
      display:flex;
      gap:10px;
      align-items:center;
      justify-content:center;
      padding-top: 12px;
    }
    .p-add{
      border-radius: 999px;
      padding: 10px 12px;
      background:#fff;
      border: 2px solid var(--brand);
      color: var(--brand);
      font-weight: 950;
      cursor:pointer;
      box-shadow: 0 10px 18px rgba(17,24,39,.05);
      transition: transform .08s ease, background .15s ease, filter .15s ease;
      width: 170px;
    }
    .p-add:hover{background: rgba(226,31,12,.06); filter:brightness(1.02);}
    .p-add:active{transform: translateY(1px);}

    /* ================= MODAL PERSONALIZAR ================= */
    #customModal {
      display: none;
      position: fixed;
      inset: 0;
      align-items: center;
      justify-content: center;
      background: rgba(17,24,39,.55);
      z-index: 9999;
      padding: 18px;
    }
    #customModal.show { display: flex; }

    .custom-sheet{
      max-width: 640px;
      width: min(640px, 100%);
      max-height: calc(100vh - 36px);
      background:#fff;
      border-radius: 22px;
      overflow:hidden;
      box-shadow: 0 28px 80px rgba(0,0,0,.35);
      border:1px solid rgba(0,0,0,.10);
      display:flex;
      flex-direction:column;
    }
    .custom-head{
      position: sticky;
      top: 0;
      z-index: 5;
      display:flex;
      justify-content:space-between;
      align-items:flex-start;
      gap:12px;
      padding:14px;
      border-bottom: 1px solid rgba(0,0,0,.10);
      background: var(--brand);
    }
    .custom-title{margin:0; font-size:20px; font-weight:950; color:#fff; line-height:1.1;}
    .custom-sub{margin:6px 0 0; color: rgba(255,255,255,.92); font-size:13px; line-height:1.35;}
    .xbtn{
      border:none;
      background:#f3f4f6;
      border:1px solid rgba(0,0,0,.10);
      border-radius:14px;
      padding:8px 10px;
      cursor:pointer;
      font-weight:950;
      flex:0 0 auto;
    }
    .custom-body{
      padding:14px;
      display:flex;
      flex-direction:column;
      gap:14px;
      overflow-y:auto;
      -webkit-overflow-scrolling: touch;
      flex: 1 1 auto;
    }
    .opt-card{
      border:1px solid rgba(0,0,0,.08);
      border-radius:18px;
      padding:12px;
      background:#fff;
      box-shadow: 0 10px 18px rgba(17,24,39,.06);
    }
    .opt-card h4{margin:0 0 10px; font-size:14px; font-weight:950;}
    .opt-grid{display:grid; grid-template-columns: 1fr 1fr; gap:10px;}
    .opt{
      border:1px solid rgba(0,0,0,.08);
      border-radius:16px;
      padding:10px;
      display:flex;
      gap:10px;
      align-items:flex-start;
      cursor:pointer;
      user-select:none;
      background:#fff;
    }
    /* ===== PRO: opciones seleccionadas tipo card ===== */
    .opt{
      transition: transform .12s ease, box-shadow .12s ease, background .12s ease, border-color .12s ease;
      position: relative;
    }
    .opt.is-checked{
      border-color: var(--brand);
      background: rgba(226,31,12,.05);
      box-shadow: 0 10px 18px rgba(226,31,12,.15);
    }
    .opt:active{ transform: scale(.98); }

    .opt:hover{background:#fafafa}
    .opt input{margin-top:2px}
    .opt small{color:#6b7280; display:block; margin-top:3px}
    .row{display:flex; gap:10px; flex-wrap:wrap; align-items:center; justify-content:space-between;}
    .qty-box{display:flex; align-items:center; gap:8px;}
    .qty-btn{
      width:38px;height:38px;border-radius:14px;border:1px solid rgba(0,0,0,.10);
      background:#f3f4f6;font-weight:950;cursor:pointer;
    }
    .qty-num{min-width:26px;text-align:center;font-weight:950;}
    .add-btn{
      border-radius:999px;
      border:none;
      background: var(--brand);
      color:#fff;
      font-weight:950;
      width: 100%;
      font-size: 15px;
      padding: 14px 16px;
      cursor:pointer;
      box-shadow: 0 16px 30px rgba(226,31,12,.20);
    }
    .custom-footer{
      position: sticky;
      bottom: 0;
      z-index: 4;
      background: linear-gradient(180deg, rgba(255,255,255,.85), #fff 40%);
      border-top: 1px solid rgba(0,0,0,.10);
    }
    .req-note{
      font-size: 12px;
      color:#6b7280;
      margin-top:-6px;
    }

    
    /* ================= RESE√ëAS (MODAL) ================= */
    #reviewsModal{display:none; position:fixed; inset:0; background:rgba(17,24,39,.55); z-index:9999; padding:18px;}
    #reviewsModal.show{display:flex; align-items:center; justify-content:center;}
    .reviews-sheet{
      max-width: 620px;
      width: min(620px, 100%);
      max-height: calc(100vh - 36px);
      background:#fff;
      border-radius:22px;
      overflow:hidden;
      box-shadow: 0 28px 80px rgba(0,0,0,.35);
      border:1px solid rgba(0,0,0,.10);
      display:flex;
      flex-direction:column;
    }
    .reviews-head{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      padding:14px;
      border-bottom: 1px solid rgba(0,0,0,.10);
      background: linear-gradient(180deg, #fff, #fff6ef);
    }
    .reviews-body{
      padding:14px;
      display:flex;
      flex-direction:column;
      gap:10px;
      overflow:auto;
      -webkit-overflow-scrolling: touch;
    }
    .rev-card{
      border:1px solid rgba(0,0,0,.10);
      border-radius:18px;
      padding:12px;
      box-shadow: 0 10px 18px rgba(17,24,39,.06);
      background:#fff;
    }
    .rev-top{display:flex; align-items:center; justify-content:space-between; gap:10px; margin-bottom:6px;}
    .rev-name{font-weight:950; font-size:13px;}
    .rev-date{color:#6b7280; font-size:12px; font-weight:800;}
    .rev-stars{display:flex; gap:2px; align-items:center;}
    .rev-stars svg{width:13px;height:13px; fill:#f59e0b;}
    .rev-text{color:#374151; font-size:13px; line-height:1.35; margin:8px 0 0;}


    /* ================= CARRITO (MODAL) ================= */
    #cartModal{display:none; position:fixed; inset:0; background:rgba(17,24,39,.55); z-index:9999;}
    .cart-sheet{
      max-width:560px;
      margin:60px auto;
      background:#fff;
      border-radius:22px;
      overflow:hidden;
      box-shadow: 0 28px 80px rgba(0,0,0,.35);
      border:1px solid rgba(0,0,0,.10);
    }

    /* ================= FOOTER ================= */
    footer{
      background: var(--brand);
      color:#fff;
      margin-top: 0;
      padding-top: 18px;
    }
    footer .fcol, footer, footer p, footer a { font-size: calc(1rem + 1px); }
    .footer-inner{
      padding: 26px 0;
      display:grid;
      grid-template-columns: 1.2fr 1fr 1fr 1.2fr;
      gap:18px;
    }
    .f-title{
      font-weight:950;
      margin: 0 0 10px;
      font-size:14px;
      color:#fff;
    }
    .f-muted{color: rgba(255,255,255,.86); font-size:13px; margin:0 0 10px; line-height:1.35;}
    .f-links{display:flex; flex-direction:column; gap:8px; font-size:13px; color: rgba(255,255,255,.90);}
    .f-links a{color: rgba(255,255,255,.92)}
    .f-links a:hover{text-decoration:underline;color:#fff}
    .footer-logo{
      width: 120px;
      height:auto;
      margin-bottom: 10px;
      filter: drop-shadow(0 10px 18px rgba(0,0,0,.18));
    }
    .contact-lines{font-size:13px;color: rgba(255,255,255,.92);display:flex;flex-direction:column;gap:8px;}
    .social{display:flex; gap:10px; align-items:center; margin-top:10px;}
    .social a{
      width:34px;height:34px;border-radius:999px;
      background: rgba(255,255,255,.14);
      border:1px solid rgba(255,255,255,.22);
      display:grid;place-items:center;
      box-shadow: 0 10px 18px rgba(0,0,0,.12);
    }
    .social svg *{stroke:#fff !important; fill:#fff !important;}
    .book-plain{display:flex; flex-direction:column; gap:10px;}
    .book-plain img{width: 160px; max-width: 100%; height:auto; object-fit:contain; background: transparent;}
    .pay-plain{display:flex; gap:10px; align-items:center; flex-wrap:wrap; margin-top:6px;}
    .pay-plain img{height:22px; width:auto; background:#fff; border-radius:8px; border:1px solid rgba(255,255,255,.12); padding:6px 8px;}
    .footer-bottom{
      border-top: 1px solid rgba(255,255,255,.18);
      padding: 12px 0;
      color: rgba(255,255,255,.85);
      font-size:12px;
    }

    /* ================= VISTA M√ìVIL ================= */
    @media (max-width: 560px){
      main { padding-bottom: 70px !important; }

      .header-wrap .container{ padding-left: 0; padding-right: 0; }
      .header-bar{
        flex-wrap: nowrap;
        padding: 0px 4px;
        border-radius: var(--radiusHeader);
        gap: 6px;
        margin: 0;
        width: 100%;
        height: 55px;
      }
      .logo{ width: 30px; height: 30px; margin-bottom: 4px; margin-left: 10px;}
      .search{
        flex: 1 1 auto;
        display: flex;
        height: 36px;
        min-width: 0;
        margin: 6px 0;
        padding: 0 10px;
        align-items: center;
      }
      .search input{ font-size: 13px; height: 95%; }
      .cart-pill{
        height: 36px;
        padding: 6px 6px;
        flex-shrink: 0;
        margin-right: 10px;
        gap: 6px;
      }
      .cart-pill .total-badge{ min-width: 70px; padding: 4px 6px; font-size: 11px; }
      .info-block{ display:none !important; }

      .rest-logo{ width:auto; height:auto; padding-right:0; margin-right:0; }
      .rest-logo::after{ display:none; }
      .opt-grid{ grid-template-columns: 1fr; }
      .footer-inner{ grid-template-columns: 1fr; gap:0; }
      .footer-inner > div{ border-bottom: 1px solid rgba(255, 255, 255, 0.18); padding: 10px 0; }
      .footer-inner > div:last-child{ border-bottom: none; }
    }

    /* ===== WhatsApp flotante ===== */
    .wa-float{
      position: fixed;
      right: 16px;
      bottom: 16px;
      width: 50px;
      height: 50px;
      border-radius: 999px;
      display: grid;
      place-items: center;
      background: transparent;
      box-shadow: none;
      z-index: 120;
      overflow: visible;
    }
    .wa-float .wa-icon{
      width: 50px;
      height: 50px;
      object-fit: contain;
      display: block;
      position: relative;
      z-index: 2;
    }
    @media (max-width: 560px){
      .wa-float{
        bottom: calc(16px + 12px + env(safe-area-inset-bottom));
      }
    }
    .wa-float::before,
    .wa-float::after{
      content:"";
      position:absolute;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -50%) scale(.75);
      width: 74px;
      height: 74px;
      border-radius: 999px;
      border: 3px solid rgba(226,31,12,.55);
      opacity: 0;
      pointer-events:none;
      z-index: 1;
      animation: waRipple 1.7s ease-out infinite;
    }
    .wa-float::after{
      width: 92px;
      height: 92px;
      border-color: rgba(226,31,12,.35);
      animation-delay: .55s;
    }
    .p-imgbox{
      height: 150px; /* antes 120px */
    }
    @keyframes waRipple{
      0%   { opacity: 0; transform: translate(-50%, -50%) scale(.70); }
      15%  { opacity: 1; }
      100% { opacity: 0; transform: translate(-50%, -50%) scale(1.25); }
    }
    @media (prefers-reduced-motion: reduce){
      .wa-float::before,
      .wa-float::after{ animation: none; opacity: 0; }
    }

    /* ===== REST HERO ‚Äì MOBILE FIX ===== */
    @media (max-width: 560px){
      /* Un solo padding lateral para TODO el hero en m√≥vil */
      .rest-hero-inner{
        flex-direction: column;
        align-items: center;
        text-align: center;
        flex-wrap: wrap;
        padding: 12px 16px;   /* <- mismo lateral para logo, meta, copy y horario */
        gap: 6px;
        box-sizing: border-box;
      }

      /* Quita paddings/m√°rgenes laterales internos (para que no se desalineen) */
      .rest-logo,
      .rest-copy,
      .rest-meta,
      .rest-hours{
        margin-left: 0 !important;
        margin-right: 0 !important;
        padding-left: 0 !important;
        padding-right: 0 !important;
        width: 100%;
        max-width: 100%;
      }

      .rest-logo{ margin: 0 auto; }
      .rest-logo img{ width: 195px; height: 150px; }

      .rest-copy{ text-align: center; }
      .rest-copy p{
        text-align: justify;
        font-size: 13.5px;
        line-height: 1.45;
        margin-top: 1px;
      }

      .rest-meta{
        justify-content: center;
        text-align: center;
      }
      .rest-rating{ justify-content: center; }

      /* Horario ocupa el mismo ancho y respeta el padding del contenedor */
      .rest-hours{
        margin-top: 6px;
        border-top: 1px solid rgba(107,114,128,.20);
        padding-top: 6px;
      }
      .rest-hours::before{ display:none; }
      .rest-hours-title{ text-align:center; }
      .rest-hours-time{ text-align:center; }
      #restStatus{ margin-left:auto; margin-right:auto; }
    }
  </style>
</head>

<body>

<header>
  <div class="header-wrap">
    <div class="container">
      <div class="header-bar">

        <a class="logo" aria-label="Pacha Eats" href="index.html" title="Volver al inicio">
          <img src="img/logos/Logo1.png" alt="Logo Pacha Eats">
        </a>

        <div class="search" role="search" aria-label="Buscar en Pacha Wok">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <path d="M21 21l-4.3-4.3m1.3-5.2a7.5 7.5 0 11-15 0 7.5 7.5 0 0115 0z"
              stroke="#e21f0c" stroke-width="2" stroke-linecap="round"/>
          </svg>
          <label class="sr-only" for="q">Buscar</label>
          <input id="q" type="search" placeholder="Buscar en Pacha Wok..." />
        </div>

        <a class="info-block delivery" href="#" aria-label="Comienza tu pedido - Ingresa una ubicaci√≥n">
          <div class="icon" aria-hidden="true">
            <svg width="36" height="36" viewBox="0 0 24 24" fill="none">
              <path d="M4 14h3l2-4h4l2 3h1.5" stroke="white" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/>
              <path d="M16 10h2.2l2.3 2.4" stroke="white" stroke-width="1.6" stroke-linecap="round"/>
              <path d="M7 18a2.2 2.2 0 100-4.4A2.2 2.2 0 007 18Z" stroke="white" stroke-width="1.6"/>
              <path d="M18 18a2.2 2.2 0 100-4.4A2.2 2.2 0 0018 18Z" stroke="white" stroke-width="1.6"/>
              <path d="M3 10h4" stroke="white" stroke-width="1.6" stroke-linecap="round"/>
              <path d="M2.5 12h3.5" stroke="white" stroke-width="1.6" stroke-linecap="round"/>
            </svg>
          </div>
          <div class="lines">
            <div class="top">Comienza tu pedido</div>
            <div class="bottom">Ingresa una ubicaci√≥n</div>
          </div>
          <div class="chev" aria-hidden="true">‚ñº</div>
        </a>

        <button class="cart-pill" id="openCart" type="button" aria-label="Abrir carrito">
          <span aria-hidden="true" style="display:grid;place-items:center;">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
              <path d="M6 6h15l-2 9H7L6 6Z" stroke="#e21f0c" stroke-width="1.8" stroke-linejoin="round"/>
              <path d="M6 6 5 3H2" stroke="#e21f0c" stroke-width="1.8" stroke-linecap="round"/>
              <circle cx="9" cy="20" r="1.6" fill="#e21f0c"/>
              <circle cx="18" cy="20" r="1.6" fill="#e21f0c"/>
            </svg>
          </span>
          <span class="total-badge" id="cartTotalBadge">S/ 0.00</span>
        </button>

      </div>
    </div>
  </div>
</header>

<main>
  <div class="container">

    <!-- ===== Encabezado restaurante ===== -->
    <section class="rest-hero" aria-label="Pacha Wok">
      <div class="rest-hero-inner">
        <div class="rest-logo" aria-hidden="true">
          <img src="img/logos/restaurantes/Pacha Wok v2.png" alt="Pacha Wok">
        </div>

        <div class="rest-copy" style="min-width:240px; flex:1;">
          <div class="rest-meta" aria-label="Ubicaci√≥n y rese√±as">
            <div class="rest-loc" title="Ubicaci√≥n">
              <span class="ico" aria-hidden="true">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                  <path d="M12 21s7-4.6 7-11a7 7 0 10-14 0c0 6.4 7 11 7 11Z" stroke="currentColor" stroke-width="1.8" />
                  <path d="M12 10.5a2.3 2.3 0 100-4.6 2.3 2.3 0 000 4.6Z" stroke="currentColor" stroke-width="1.8" />
                </svg>
              </span>
              <span class="txt">Pachacamac</span>
            </div>

            <button class="rest-rating" id="openReviews" type="button" aria-label="Ver opiniones">
              <span class="stars" aria-hidden="true">
                <svg viewBox="0 0 24 24"><path d="M12 17.3 6.2 20.6l1.1-6.5L2.6 9.6l6.6-1L12 2.7l2.8 5.9 6.6 1-4.7 4.5 1.1 6.5z"/></svg>
                <svg viewBox="0 0 24 24"><path d="M12 17.3 6.2 20.6l1.1-6.5L2.6 9.6l6.6-1L12 2.7l2.8 5.9 6.6 1-4.7 4.5 1.1 6.5z"/></svg>
                <svg viewBox="0 0 24 24"><path d="M12 17.3 6.2 20.6l1.1-6.5L2.6 9.6l6.6-1L12 2.7l2.8 5.9 6.6 1-4.7 4.5 1.1 6.5z"/></svg>
                <svg viewBox="0 0 24 24"><path d="M12 17.3 6.2 20.6l1.1-6.5L2.6 9.6l6.6-1L12 2.7l2.8 5.9 6.6 1-4.7 4.5 1.1 6.5z"/></svg>
                <svg viewBox="0 0 24 24"><path d="M12 17.3 6.2 20.6l1.1-6.5L2.6 9.6l6.6-1L12 2.7l2.8 5.9 6.6 1-4.7 4.5 1.1 6.5z"/></svg>
              </span>
              <span class="rating-text"><b>5.0</b> (128 opiniones)</span>
              <span class="chev" aria-hidden="true">‚Ä∫</span>
            </button>
          </div>

          <p><b>Alitas, costillitas y combos bien cargados</b>: sabores BBQ, Hot BBQ, Buffalo, Jack Daniel‚Äôs y Oriental. Perfecto para compartir con papas crujientes y una bebida heladita.</p>
        </div>

        <div class="rest-hours" aria-label="Horario de atenci√≥n">
          <div class="rest-status" id="restStatus" aria-live="polite">‚Äî</div>
          <div class="rest-hours-title">Horario de atenci√≥n</div>
          <div class="rest-hours-time">De Lunes a Domingo de 12:00 p.m. a 11:00 p.m.</div>
        </div>
      </div>
    </section>

    <!-- ===== Tabs secciones ===== -->
    <section class="tabs" aria-label="Secciones">
      <div class="tabs-inner" id="tabs"></div>
    </section>

    <!-- ===== Productos ===== -->
    <section class="block" id="menuRoot" aria-label="Carta Pacha Wok's"></section>

  </div>
</main>

<!-- ================= MODAL PERSONALIZAR ================= -->
<div id="customModal" aria-hidden="true">
  <div class="custom-sheet" role="dialog" aria-label="Personaliza tu producto">
    <div class="custom-head">
      <div>
        <h3 class="custom-title" id="customTitle">Personaliza tu producto</h3>
        <p class="custom-sub" id="customSub">‚Äî</p>
      </div>
      <button class="xbtn" id="closeCustom" type="button">‚úï</button>
    </div>

    <div class="custom-body">
      <div class="req-note" id="reqNote"></div>

      <div id="customGroups"></div>

      <div class="opt-card custom-footer">
        <div class="row">
          <div>
            <div style="font-size:12px; color:#6b7280;">Total</div>
            <div style="font-weight:950; font-size:18px;" id="customTotal">S/ 0.00</div>
            <div style="font-size:12px; color:#6b7280;" id="customBreakdown"></div>
          </div>
          <div class="qty-box">
            <button class="qty-btn" id="qtyDec" type="button">‚àí</button>
            <div class="qty-num" id="qtyNum">1</div>
            <button class="qty-btn" id="qtyInc" type="button">+</button>
          </div>
        </div>

        <div style="margin-top:12px; display:flex; justify-content:stretch;">
          <button class="add-btn" id="addFromCustom" type="button">Agregar al carrito</button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- ================= CARRITO (MODAL) ================= -->
<div id="cartModal" aria-hidden="true">
  <div class="cart-sheet">
    <div style="display:flex; align-items:center; justify-content:space-between; padding:14px; border-bottom:1px solid rgba(0,0,0,.08); background: linear-gradient(180deg, #fff, #fff6ef);">
      <strong>üõí Tu carrito</strong>
      <button id="closeCart" type="button"
        style="border:none; background:#f3f4f6; border:1px solid rgba(0,0,0,.10); border-radius:14px; padding:8px 10px; cursor:pointer; font-weight:950;">‚úï</button>
    </div>

    <div id="cartItems" style="padding:14px; display:flex; flex-direction:column; gap:10px; max-height:55vh; overflow:auto;"></div>

    <div style="padding:14px; border-top:1px solid rgba(0,0,0,.08); display:flex; align-items:center; justify-content:space-between; gap:10px; flex-wrap:wrap;">
      <strong>Total: <span id="cartTotalText">S/ 0.00</span></strong>
      <div style="display:flex; gap:8px; flex-wrap:wrap;">
        <button id="clearCart" type="button"
          style="border-radius:999px; border:1px solid rgba(0,0,0,.10); background:#fff; padding:10px 12px; font-weight:950; cursor:pointer;">Vaciar</button>
        <button id="checkout" type="button"
          style="border-radius:999px; border:none; background:#111; color:#fff; padding:10px 12px; font-weight:950; cursor:pointer;">Finalizar</button>
      </div>
    </div>
  </div>
</div>
<!-- ================= RESE√ëAS (MODAL) ================= -->
<div id="reviewsModal" aria-hidden="true">
  <div class="reviews-sheet" role="dialog" aria-label="Opiniones">
    <div class="reviews-head">
      <div>
        <div style="font-weight:950; font-size:16px;">Opiniones</div>
        <div style="color:#6b7280; font-size:13px;"><span id="reviewsSummary">‚Äî</span></div>
      </div>
      <button id="closeReviews" type="button" class="xbtn">‚úï</button>
    </div>
    <div class="reviews-body" id="reviewsBody"></div>
  </div>
</div>



<footer>
  <div class="container">
    <div class="footer-inner">

      <div>
        <img class="footer-logo" src="img/logos/Logo2.png" alt="Logo Pacha Eats">
        <div class="f-title">Con√©ctate con nosotros</div>

        <div class="contact-lines">
          <div><b>Whatsapp:</b> +51925915905</div>
          <div><b>Correo:</b> contacto@pachaeats.com</div>
        </div>

        <div class="social" aria-label="Redes">
          <a href="#" aria-label="Instagram">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
              <path d="M7 2h10a5 5 0 015 5v10a5 5 0 01-5 5H7a5 5 0 01-5-5V7a5 5 0 015-5Z" stroke="#fff" stroke-width="1.8"/>
              <path d="M12 17a5 5 0 100-10 5 5 0 000 10Z" stroke="#fff" stroke-width="1.8"/>
              <path d="M17.5 6.5h.01" stroke="#fff" stroke-width="3" stroke-linecap="round"/>
            </svg>
          </a>
          <a href="#" aria-label="Facebook">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
              <path d="M14 8h3V5h-3a4 4 0 00-4 4v3H7v3h3v7h3v-7h3l1-3h-4V9a1 1 0 011-1Z" fill="#fff"/>
            </svg>
          </a>
          <a href="#" aria-label="TikTok">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" aria-hidden="true">
              <path d="M14 3v10.2a4.3 4.3 0 11-3.2-4.1V6.7a7.8 7.8 0 003.2 1.2c1.1.2 2.3.1 3.4-.2V4.5c-1.2.4-2.5.4-3.7-.1A4.7 4.7 0 0114 3Z" fill="#fff"/>
            </svg>
          </a>
        </div>
      </div>

      <div>
        <div class="f-title">Sobre Nosotros</div>
        <div class="f-links">
          <a href="#">Trabaja con nosotros</a>
          <a href="#">Horarios, locales y zonas de reparto</a>
          <a href="#">Ventas corporativas</a>
          <a href="#">Comprobantes electr√≥nicos</a>
        </div>
      </div>

      <div>
        <div class="f-title">Pol√≠ticas &amp; T√©rminos</div>
        <div class="f-links">
          <a href="#">T√©rminos y condiciones de la web</a>
          <a href="#">Pol√≠ticas de privacidad</a>
          <a href="#">Pol√≠ticas de delivery y pick up</a>
          <a href="#">T√©rminos y condiciones de promociones y campa√±as</a>
          <a href="#">L√≠nea √âtica</a>
          <a href="#">Pol√≠tica de cookies</a>
        </div>
      </div>

      <div>
        <div class="f-title">Libro de reclamaciones</div>
        <div class="book-plain">
          <img src="img/logos/Libro.png" alt="Libro de reclamaciones">
        </div>

        <div class="f-title" style="margin-top:14px;">M√©todos de Pago</div>
        <div class="pay-plain">
          <img alt="Visa" src="https://upload.wikimedia.org/wikipedia/commons/5/5e/Visa_Inc._logo.svg">
          <img alt="Mastercard" src="https://upload.wikimedia.org/wikipedia/commons/2/2a/Mastercard-logo.svg">
          <img alt="Amex" src="https://upload.wikimedia.org/wikipedia/commons/3/30/American_Express_logo.svg">
        </div>
      </div>

    </div>

    <div class="footer-bottom">
      ¬© <span id="year"></span> Pacha Eats. Todos los derechos reservados.
    </div>
  </div>
</footer>

<!-- WhatsApp flotante -->
<a
  class="wa-float"
  href="https://wa.me/51925915905?text=Hola%20Pacha%20Eats%2C%20quisiera%20hacer%20un%20pedido%20de%20Pacha%20Wok."
  target="_blank"
  rel="noopener"
  aria-label="Chatear por WhatsApp"
>
  <img class="wa-icon" src="img/logos/LogoWhatsappRojo.png" alt="WhatsApp">
</a>

<script>
  // ================== HELPERS ==================
  const CART_KEY = "pacha_cart_v_wok_1";
  const $ = (s) => document.querySelector(s);
  const $$ = (s) => Array.from(document.querySelectorAll(s));
  const money = (n) => "S/ " + Number(n||0).toFixed(2);
  const drinkImg = (filename) => `img/productos/bebidas/${filename}`;
  const extraImg = (filename) => `img/productos/extras/${filename}`;
  const escapeHtml = (str) => String(str).replace(/[&<>"']/g, m => ({
    "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"
  }[m]));

  // ================== HORARIO (America/Lima) ==================
  // Horario: Lunes a Domingo 12:00 - 23:00
  const STORE_SCHEDULE = {
    tz: "America/Lima",
    daily: { open: "12:00", close: "23:00" } // 24h
  };

  function nowInTZ(tz){
    // Creamos un Date usando partes de la zona horaria para evitar problemas de timezone del dispositivo
    const parts = new Intl.DateTimeFormat("en-US", {
      timeZone: tz,
      year:"numeric", month:"2-digit", day:"2-digit",
      hour:"2-digit", minute:"2-digit", second:"2-digit",
      hour12:false
    }).formatToParts(new Date()).reduce((acc,p)=>{acc[p.type]=p.value; return acc;}, {});
    return new Date(`${parts.year}-${parts.month}-${parts.day}T${parts.hour}:${parts.minute}:${parts.second}`);
  }

  function hhmmToMinutes(hhmm){
    const [h,m] = String(hhmm).split(":").map(Number);
    return (h*60) + (m||0);
  }

  function isStoreOpen(){
    const d = nowInTZ(STORE_SCHEDULE.tz);
    const mins = d.getHours()*60 + d.getMinutes();
    const openM = hhmmToMinutes(STORE_SCHEDULE.daily.open);
    const closeM = hhmmToMinutes(STORE_SCHEDULE.daily.close);
    // NO cruza medianoche
    return mins >= openM && mins < closeM;
  }

  function applyStoreStatusUI(){
    const badge = document.getElementById("restStatus");
    if(!badge) return;
    const open = isStoreOpen();
    badge.classList.toggle("open", open);
    badge.classList.toggle("closed", !open);
    badge.textContent = open ? "Abierto" : "Cerrado";
  }


  // ================== OPCIONES REUTILIZABLES (JIJUNAS) ==================
  const OPT = {
  bebidasStd_opcional: {
      id:"bebida",
      title:"¬øAlguna bebida personal?",
      type:"radio",
      required:false,
      choices:[
        { id:"none",  label:"Sin bebida", add:0 },
    
        { id:"inca600", label:"Inca Kola 600 ml.", add:4.00, img: drinkImg("Inca Kila 600 ml.jpg") },
        { id:"coca600", label:"Coca Cola 600 ml.", add:4.00, img: drinkImg("Coca Cola 600 ml.jpg") },
    
        // Nota: tu imagen es Pepsi 750 ml (la usamos para Pepsi)
        { id:"pepsi",   label:"Pepsi 750 ml.", add:3.00, img: drinkImg("Pepsi 750 ml.jpg") },
    
        // Nota: tu imagen dice Guarana 450 ml
        { id:"gua",     label:"Guaran√° 450 ml.", add:3.00, img: drinkImg("Guarana 450 ml.jpg") },
    
        { id:"lim900",  label:"Limonada 900 ml.", add:4.90, img: drinkImg("Limonada 900 ml.jpg") },
        { id:"mar900",  label:"Maracuy√° 900 ml.", add:5.90, img: drinkImg("Maracuya 900 ml.jpg") },
        { id:"chi900",  label:"Chicha morada 900 ml.", add:6.90, img: drinkImg("Chicha Morada 900 ml.jpg") }
      ],
      defaultId:"none"
    },

  bebidasIncluidas_gratis: {
      id:"bebida_incluida",
      title:"Bebida incluida (gratis)",
      type:"radio",
      required:true,
      choices:[
        { id:"pepsi",   label:"Pepsi 750 ml. (seleccionado)", add:0.00, img: drinkImg("Pepsi 750 ml.jpg") },
        { id:"inca600", label:"Inca Kola 600 ml.", add:0.00, img: drinkImg("Inca Kila 600 ml.jpg") },
        { id:"coca600", label:"Coca Cola 600 ml.", add:0.00, img: drinkImg("Coca Cola 600 ml.jpg") },
        { id:"gua",     label:"Guaran√° 450 ml.", add:0.00, img: drinkImg("Guarana 450 ml.jpg") },
        { id:"lim900",  label:"Limonada 900 ml.", add:0.00, img: drinkImg("Limonada 900 ml.jpg") },
        { id:"mar900",  label:"Maracuy√° 900 ml.", add:0.00, img: drinkImg("Maracuya 900 ml.jpg") },
        { id:"chi900",  label:"Chicha morada 900 ml.", add:0.00, img: drinkImg("Chicha Morada 900 ml.jpg") }
      ],
      defaultId:"pepsi"
    },

  salsasOrientales: {
  id:"salsas",
  title:"Salsas orientales",
  type:"check",
  required:false,
  choices:[
    { id:"tam", label:"Salsa tamarindo", add:0 },
    { id:"soya", label:"Salsa de soya", add:0 },
  ],
  defaultIds:["tam"]
},
wantanSide: {
  id:"wantan_side",
  title:"Wantanes fritos",
  type:"radio",
  required:false,
  choices:[
    { id:"none", label:"Sin wantanes", add:0 },
    { id:"3", label:"3 und", add:5.00 },
    { id:"6", label:"6 und", add:9.00 },
    { id:"12", label:"12 und", add:16.00 }
  ],
  defaultId:"none"
},
wantanSide_comboClasico: {
  id:"wantan_side",
  title:"Wantanes fritos",
  type:"radio",
  required:true,
  choices:[
    { id:"3", label:"3 und (seleccionado)", add:0.00 },
    { id:"6", label:"6 und", add:9.00 },
    { id:"12", label:"12 und", add:16.00 }
  ],
  defaultId:"3"
},
tipoArrozChaufa: {
  id:"tipo_arroz",
  title:"Tipo de arroz chaufa",
  type:"radio",
  required:true,
  choices:[
    { id:"pollo", label:"Chaufa de Pollo", add:0 },
    { id:"chancho", label:"Chaufa de chancho", add:2.00 },
    { id:"especial", label:"Chaufa especial", add:15.00 }
  ],
  defaultId:"pollo"
},
tipoArrozChaufa_combo: {
  id:"tipo_arroz",
  title:"Tipo de arroz chaufa",
  type:"radio",
  required:true,
  choices:[
    { id:"pollo", label:"Chaufa de Pollo", add:0 },
    { id:"chancho", label:"Chaufa de chancho", add:2.00 },
    { id:"especial", label:"Chaufa especial", add:5.00 }
  ],
  defaultId:"pollo"
},
tamanioMedGrande: {
  id:"tam",
  title:"Tama√±o",
  type:"radio",
  required:true,
  choices:[
    { id:"med", label:"Mediano", add:0 },
    { id:"gde", label:"Grande", add:5.00 }
  ],
  defaultId:"med"
},
tipoAeropuerto: {
  id:"tipo_aero",
  title:"Tipo de aeropuerto",
  type:"radio",
  required:true,
  choices:[
    { id:"pollo", label:"Aeropuerto de pollo", add:0 },
    { id:"chancho", label:"Aeropuerto de chancho", add:3.00 },
    { id:"especial", label:"Aeropuerto especial", add:12.00 }
  ],
  defaultId:"pollo"
},
tipoTallarin: {
  id:"tipo_tallarin",
  title:"Tipo de tallar√≠n",
  type:"radio",
  required:true,
  choices:[
    { id:"pollo", label:"Pollo", add:0 },
    { id:"chancho", label:"Chancho", add:3.00 },
    { id:"especial", label:"Especial", add:15.00 }
  ],
  defaultId:"pollo"
},
tipoCombinado: {
  id:"tipo_comb",
  title:"Tipo de combinado",
  type:"radio",
  required:true,
  choices:[
    { id:"pollo", label:"Combinado de pollo", add:0 },
    { id:"chancho", label:"Combinado de chancho", add:3.00 },
    { id:"especial", label:"Combinado especial", add:13.00 }
  ],
  defaultId:"pollo"
},
sopaWantanTipo: {
  id:"tipo_sopa",
  title:"Tipo de sopa",
  type:"radio",
  required:true,
  choices:[
    { id:"pollo", label:"Pollo", add:0 },
    { id:"chancho", label:"Chancho", add:5.00 },
    { id:"especial", label:"Especial", add:7.00 }
  ],
  defaultId:"pollo"
},
dimsum_wantanFrito_tamanio: {
  id:"tamanio_dimsum",
  title:"Tama√±o",
  type:"radio",
  required:true,
  choices:[
    { id:"6", label:"6 und", add:0 },
    { id:"12", label:"12 und", add:7.00 }
  ],
  defaultId:"6"
},
dimsum_wantanesPW_tamanio: {
  id:"tamanio_dimsum",
  title:"Tama√±o",
  type:"radio",
  required:true,
  choices:[
    { id:"3", label:"3 und", add:0 },
    { id:"6", label:"6 und", add:5.00 },
    { id:"12", label:"12 und", add:14.00 }
  ],
  defaultId:"3"
},
arrozEspeciales: {
  id:"arroz_especial",
  title:"Tipo de arroz",
  type:"radio",
  required:true,
  choices:[
    { id:"simple", label:"Chaufa simple", add:0 },
    { id:"pollo", label:"Chaufa de pollo", add:3.00 },
    { id:"chancho", label:"Chaufa de chancho", add:4.00 },
    { id:"especial", label:"Chaufa especial", add:5.00 }
  ],
  defaultId:"simple"
},
bebidaFamiliar: {
  id:"bebida_fam",
  title:"Alguna bebida familiar",
  type:"radio",
  required:true,
  choices:[
    { id:"inca15", label:"Inka Cola 1.5 Lt", add:8.50 },
    { id:"pepsi15", label:"Pepsi 1.5 Lt", add:6.50 },
    { id:"coca15", label:"Coca cola 1.5 Lt", add:8.00 }
  ],
  defaultId:"pepsi15"
}
};

  // ================== DATA MENU ==================
  const SECTIONS = [
    { id:"combos",    name:"Combos" },
    { id:"dimsums",   name:"Dim Sums" },
    { id:"sopas",     name:"Sopas" },
    { id:"clasicos",  name:"Cl√°sicos" },
    { id:"especiales",name:"Especiales" },
    { id:"banquetes", name:"Banquetes" }
  ];

  const menu = [
    // ===== Combos =====
    {
      id:"combo_personal_clasico",
      section:"combos",
      name:"Combo personal Cl√°sico",
      desc:"01 chaufa + 03 wantanes fritos + 01 gaseosa",
      price:14.90,
      groups:[
        OPT.tipoArrozChaufa_combo,
        OPT.bebidasIncluidas_gratis,
        OPT.wantanSide_comboClasico
      ]
    },
    {
      id:"combo_para_2",
      section:"combos",
      name:"Combo para 2",
      desc:"01 Arroz chaufa grande + 01 porci√≥n de Chi Jau Kay + 01 porci√≥n de Tipakay + 04 wantanes fritos",
      price:44.90,
      groups:[
        OPT.bebidasStd_opcional
      ]
    },

    // ===== Dim Sums =====
    {
      id:"dimsum_wantan_frito",
      section:"dimsums",
      name:"Wantan frito",
      desc:"Porci√≥n de wantanes rellenos acompa√±ados con salsa tamarindo.",
      price:9.00,
      groups:[ OPT.dimsum_wantanFrito_tamanio ]
    },
    {
      id:"dimsum_wantanes_pacha_wok",
      section:"dimsums",
      name:"Wantanes Pacha Wok",
      desc:"Wantan frito relleno con chanchito y langostinos picados, acompa√±ados de tamarindo Kam Lu.",
      price:7.00,
      groups:[ OPT.dimsum_wantanesPW_tamanio ]
    },

    // ===== Sopas =====
    {
      id:"sopa_wantan",
      section:"sopas",
      name:"Sopa Want√°n",
      desc:"La tradicional sopa a base de wantan relleno. P√≠dela de pollo, chancho o versi√≥n especial.",
      price:15.00,
      groups:[ OPT.sopaWantanTipo ]
    },
    {
      id:"sopa_pac_pow",
      section:"sopas",
      name:"Sopa Pac Pow",
      desc:"Mezcla de fideo fansy + huevo batido.",
      price:17.00,
      groups:[ OPT.salsasOrientales ]
    },
    {
      id:"sopa_womin",
      section:"sopas",
      name:"Sopa Wom√≠n",
      desc:"Sopa a base de pollo.",
      price:16.00,
      groups:[ OPT.salsasOrientales ]
    },
    {
      id:"sopa_fuchifu",
      section:"sopas",
      name:"Sopa Fuchif√∫",
      desc:"La mezcla perfecta de huevo batido y verduras picadas.",
      price:17.00,
      groups:[ OPT.salsasOrientales ]
    },

    // ===== Cl√°sicos =====
    {
      id:"arroz_chaufa",
      section:"clasicos",
      name:"Arroz Chaufa",
      desc:"El cl√°sico chaufa flameado en el wok.",
      price:18.00,
      groups:[
        OPT.tamanioMedGrande,
        OPT.tipoArrozChaufa,
        OPT.salsasOrientales,
        OPT.bebidasStd_opcional,
        OPT.wantanSide
      ]
    },
    {
      id:"aeropuerto",
      section:"clasicos",
      name:"Aeropuerto",
      desc:"Infaltable en nuestra carta, con su toque flameado.",
      price:20.00,
      groups:[
        OPT.tamanioMedGrande,
        OPT.tipoAeropuerto,
        OPT.bebidasStd_opcional,
        OPT.salsasOrientales,
        OPT.wantanSide
      ]
    },
    {
      id:"tallarin_saltado",
      section:"clasicos",
      name:"Tallar√≠n saltado",
      desc:"Tallar√≠n y verduras salteadas en el wok.",
      price:18.00,
      groups:[
        OPT.tipoTallarin,
        OPT.salsasOrientales,
        OPT.bebidasStd_opcional,
        OPT.wantanSide
      ]
    },
    {
      id:"combinado",
      section:"clasicos",
      name:"Combinado",
      desc:"Tallar√≠n saltado + chaufa flameado en el wok.",
      price:20.00,
      groups:[
        OPT.tamanioMedGrande,
        OPT.tipoCombinado,
        OPT.bebidasStd_opcional,
        OPT.salsasOrientales,
        OPT.wantanSide
      ]
    },

    // ===== Especiales (Tipakay -> Kam l√∫ wantan con tipo arroz obligatorio + bebida + salsas + wantan) =====
    {
      id:"tipakay",
      section:"especiales",
      name:"Tipakay",
      desc:"Pollo empanizado en salsa tamarindo, acompa√±ado con arroz chaufa.",
      price:20.00,
      groups:[ OPT.arrozEspeciales, OPT.bebidasStd_opcional, OPT.salsasOrientales, OPT.wantanSide ]
    },
    {
      id:"chijaukay",
      section:"especiales",
      name:"Chijaukay",
      desc:"Pollo en trozos con salsa de mens√≠, taus√≠ y sillao, acompa√±ado con arroz chaufa.",
      price:20.00,
      groups:[ OPT.arrozEspeciales, OPT.bebidasStd_opcional, OPT.salsasOrientales, OPT.wantanSide ]
    },
    {
      id:"pollo_con_verduras",
      section:"especiales",
      name:"Pollo con verduras",
      desc:"Pollo y verduras salteados al wok con salsa de osti√≥n, acompa√±ado de arroz chaufa.",
      price:19.00,
      groups:[ OPT.arrozEspeciales, OPT.bebidasStd_opcional, OPT.salsasOrientales, OPT.wantanSide ]
    },
    {
      id:"pollo_con_pina",
      section:"especiales",
      name:"Pollo con pi√±a",
      desc:"Pechuga de pollo y pi√±a en salsa tamarindo, servido con arroz chaufa.",
      price:21.00,
      groups:[ OPT.arrozEspeciales, OPT.bebidasStd_opcional, OPT.salsasOrientales, OPT.wantanSide ]
    },
    {
      id:"kam_lu_wantan",
      section:"especiales",
      name:"Kam l√∫ wantan",
      desc:"Pollo, chancho, res, verduras y wantanes en salsa tamarindo + arroz chaufa.",
      price:21.00,
      groups:[ OPT.arrozEspeciales, OPT.bebidasStd_opcional, OPT.salsasOrientales, OPT.wantanSide ]
    },

    // ===== Especiales (los dem√°s: bebida + salsas + wantan) =====
    {
      id:"tallarin_taypa",
      section:"especiales",
      name:"Tallar√≠n Tayp√°",
      desc:"Tallar√≠n con todas las carnes, verduras salteadas al wok y a la plancha.",
      price:33.00,
      groups:[ OPT.bebidasStd_opcional, OPT.salsasOrientales, OPT.wantanSide ]
    },
    {
      id:"lomo_chaufero",
      section:"especiales",
      name:"Lomo chaufero",
      desc:"Lomo saltado con toque oriental, acompa√±ado con papas fritas y arroz chaufa.",
      price:24.00,
      groups:[ OPT.bebidasStd_opcional, OPT.salsasOrientales, OPT.wantanSide ]
    },
    {
      id:"aeropuer_top",
      section:"especiales",
      name:"Aeropuer-TOP",
      desc:"Aeropuerto con todas las carnes + porci√≥n de Chijaukay + porci√≥n de Tipakay",
      price:39.90,
      groups:[ OPT.bebidasStd_opcional, OPT.salsasOrientales, OPT.wantanSide ]
    },

    // ===== Banquetes =====
    {
      id:"combo_familiar_1",
      section:"banquetes",
      name:"Combo familiar 1",
      desc:"02 Chaufa grande + 01 Chi Jau Kay + 01 Kam Lu Wantan + 01 Tallar√≠n especial + 12 wantanes fritos",
      price:135.00,
      groups:[ OPT.bebidaFamiliar ]
    },
    {
      id:"combo_familiar_2",
      section:"banquetes",
      name:"Combo familiar 2",
      desc:"02 Chaufa grande + 01 Tipakay + 01 Taypa + 01 Tallar√≠n especial + 12 wantanes fritos",
      price:145.00,
      groups:[ OPT.bebidaFamiliar ]
    },
    {
      id:"combo_para_8",
      section:"banquetes",
      name:"Combo para 8",
      desc:"02 Chaufa grande + 01 Aeropuerto de chancho + 01 Tipakay + 01 Chijaukay + 01 Kam Lu Wantan + 01 Tallar√≠n especial + 12 Wantanes",
      price:160.00,
      groups:[ OPT.bebidaFamiliar ]
    }
  ];

  // ================== CART ==================
  let cart = loadCart();
  function loadCart(){
    try{ const raw = localStorage.getItem(CART_KEY); return raw ? JSON.parse(raw) : {}; }
    catch(e){ return {}; }
  }
  function saveCart(){ localStorage.setItem(CART_KEY, JSON.stringify(cart)); }
  function cartTotal(){ return Object.values(cart).reduce((acc, it) => acc + it.price*it.qty, 0); }
  function addToCartLine({ key, name, price, qty }){
    if(!cart[key]) cart[key] = { id:key, name, price, qty:0 };
    cart[key].qty += qty;
    saveCart();
    renderCartBadge();
  }
  function changeQty(key, delta){
    if(!cart[key]) return;
    cart[key].qty += delta;
    if(cart[key].qty <= 0) delete cart[key];
    saveCart();
    renderCartBadge();
    renderCartModal();
  }
  function clearCart(){ cart = {}; saveCart(); renderCartBadge(); renderCartModal(); }
  function renderCartBadge(){
    $("#cartTotalBadge").textContent = money(cartTotal());
    $("#cartTotalText").textContent = money(cartTotal());
  }

  // ================== UI: TABS + MENU RENDER ==================
  let activeSection = "all"; // inicia mostrando TODO

  function productCardHTML(p){
    const imgPath = `img/productos/pacha-wok/${p.name}.jpg`;
    return `
      <article class="p-card product-card">
        <div class="p-imgbox">
          <img
            src="${imgPath}"
            alt="${escapeHtml(p.name)}"
            onerror="this.style.display='none'; this.parentElement.innerHTML='<div class=ph>Jijuna\\'s</div>'"
          >
        </div>

        <p class="p-name">${escapeHtml(p.name)}</p>
        <p class="p-desc">${escapeHtml(p.desc || "")}</p>
        <div class="p-price">${money(p.price)}</div>

        <div class="p-actions">
          <button class="p-add" type="button" data-open-custom="${p.id}">
            Agregar
          </button>
        </div>
      </article>
    `;
  }

  function buildTabs(){
    const root = $("#tabs");
    root.innerHTML = "";

    const allBtn = document.createElement("button");
    allBtn.className = "tab" + (activeSection === "all" ? " active" : "");
    allBtn.type = "button";
    allBtn.textContent = "Todos";
    allBtn.addEventListener("click", () => {
      activeSection = "all";
      buildTabs();
      renderMenu();
      const menuRoot = $("#menuRoot");
      window.scrollTo({ top: menuRoot.getBoundingClientRect().top + window.scrollY - 120, behavior:"smooth" });
    });
    root.appendChild(allBtn);

    SECTIONS.forEach(s => {
      const b = document.createElement("button");
      b.className = "tab" + (s.id === activeSection ? " active" : "");
      b.type = "button";
      b.textContent = s.name;
      b.addEventListener("click", () => {
        activeSection = s.id;
        buildTabs();
        renderMenu();
        const menuRoot = $("#menuRoot");
        window.scrollTo({ top: menuRoot.getBoundingClientRect().top + window.scrollY - 120, behavior:"smooth" });
      });
      root.appendChild(b);
    });
  }

  function renderMenu(){
    const root = $("#menuRoot");
    const q = ($("#q").value || "").trim().toLowerCase();

    if (activeSection !== "all" && !SECTIONS.some(s => s.id === activeSection)) {
      activeSection = "all";
    }

    const secName =
      activeSection === "all"
        ? "Todos los productos"
        : (SECTIONS.find(s => s.id === activeSection)?.name || "Carta");

    let list = Array.isArray(menu) ? menu.slice() : [];

    if (activeSection !== "all") {
      list = list.filter(p => p.section === activeSection);
    }

    if (q) {
      list = list.filter(p => (p.name + " " + (p.desc || "")).toLowerCase().includes(q));
    }

    root.innerHTML = `
      <div class="block-title">
        <h3>${escapeHtml(secName)}</h3>
        <small>${list.length} item(s)</small>
      </div>
      <div class="grid">
        ${
          list.length
            ? list.map(productCardHTML).join("")
            : `<div style="grid-column:1/-1; background:rgba(255,255,255,.88); border:1px dashed rgba(0,0,0,.15); border-radius:18px; padding:14px; color:#6b7280;">
                No se encontraron productos con ese nombre.
              </div>`
        }
      </div>
    `;

    root.querySelectorAll("[data-open-custom]").forEach(btn => {
      btn.addEventListener("click", () => {
        const id = btn.getAttribute("data-open-custom");
        const p = menu.find(x => x.id === id);
        if(!p) return;
        openCustomize(p);
      });
    });
  }

  $("#q").addEventListener("input", renderMenu);

  // ================== RESE√ëAS (demo) ==================
  const REVIEWS = [
    { name:"Mar√≠a P.",  rating:5, date:"Hace 2 d√≠as", text:"Las alitas orientales est√°n brutales. Lleg√≥ calientito y con papas bien crujientes." },
    { name:"Carlos R.", rating:5, date:"Hace 1 semana", text:"Buen tama√±o y buena salsa. El combo broaster est√° buenazo." },
    { name:"Andrea V.", rating:5, date:"Hace 2 semanas", text:"Me encant√≥ el sabor Jack Daniel's. Recomendado para compartir." },
    { name:"Luis G.",   rating:5, date:"Hace 1 mes", text:"Pachacamac necesitaba algo as√≠. R√°pida atenci√≥n y buena porci√≥n." }
  ];

  function starsHTML(n){
    const s = [];
    for(let i=0;i<5;i++){
      s.push(`<svg viewBox="0 0 24 24" aria-hidden="true"><path d="M12 17.3 6.2 20.6l1.1-6.5L2.6 9.6l6.6-1L12 2.7l2.8 5.9 6.6 1-4.7 4.5 1.1 6.5z"/></svg>`);
    }
    return `<span class="rev-stars">${s.join("")}</span>`;
  }

  function openReviews(){
    const modal = document.getElementById("reviewsModal");
    if(!modal) return;

    const avg = 5.0; // demo
    document.getElementById("reviewsSummary").textContent = `${avg.toFixed(1)} ‚Ä¢ ${REVIEWS.length} opiniones destacadas`;

    const body = document.getElementById("reviewsBody");
    body.innerHTML = REVIEWS.map(r => `
      <div class="rev-card">
        <div class="rev-top">
          <div>
            <div class="rev-name">${escapeHtml(r.name)}</div>
            <div>${starsHTML(r.rating)}</div>
          </div>
          <div class="rev-date">${escapeHtml(r.date)}</div>
        </div>
        <div class="rev-text">${escapeHtml(r.text)}</div>
      </div>
    `).join("");

    modal.classList.add("show");
    modal.setAttribute("aria-hidden","false");
  }

  function closeReviews(){
    const modal = document.getElementById("reviewsModal");
    if(!modal) return;
    modal.classList.remove("show");
    modal.setAttribute("aria-hidden","true");
  }



  // INIT
  buildTabs();
  renderMenu();
  renderCartBadge();
  $("#year").textContent = String(new Date().getFullYear());

  // Estado abierto/cerrado
  applyStoreStatusUI();
  setInterval(applyStoreStatusUI, 60 * 1000);

  // ===== Header auto-hide (muestra al subir) =====
  (function(){
    const header = document.querySelector("header");
    if(!header) return;

    let lastY = window.scrollY;
    let ticking = false;

    function update(){
      const y = window.scrollY;
      const delta = Math.abs(y - lastY);
      if(delta < 8) return;

      const goingDown = y > lastY;
      if(goingDown && y > 120){
        header.classList.add("is-hidden");
      }else{
        header.classList.remove("is-hidden");
      }
      lastY = y;
    }

    window.addEventListener("scroll", () => {
      if(!ticking){
        requestAnimationFrame(() => {
          update();
          ticking = false;
        });
        ticking = true;
      }
    }, { passive:true });
  })();

  // ================== MODAL PERSONALIZAR (DIN√ÅMICO) ==================
  let customProduct = null;
  let customQty = 1;
  let selections = {}; // groupId -> (radioId|string) or (array for check)

  function openCustomize(p){
    customProduct = p;
    customQty = 1;
    selections = {};

    // Header PRO: el producto es el protagonista
    $("#customTitle").textContent = p.name;
    $("#customSub").textContent = "Personaliza tu producto ‚Ä¢ Base: " + money(p.price);
    $("#qtyNum").textContent = "1";

    (p.groups || []).forEach(g => {
      if(g.type === "radio"){
        selections[g.id] = (g.defaultId ?? (g.choices?.[0]?.id));
      } else if(g.type === "check"){
        selections[g.id] = Array.isArray(g.defaultIds) ? [...g.defaultIds] : [];
      }
    });

    renderCustomGroups();
    updateCustomTotal();

    const cm = $("#customModal");
    cm.classList.add("show");
    cm.setAttribute("aria-hidden","false");
  }

  function closeCustomize(){
    const cm = $("#customModal");
    cm.classList.remove("show");
    cm.setAttribute("aria-hidden","true");
    customProduct = null;
    selections = {};
  }

  $("#closeCustom").addEventListener("click", closeCustomize);
  $("#customModal").addEventListener("click", (e) => { if(e.target.id === "customModal") closeCustomize(); });

  function renderCustomGroups(){
    const root = $("#customGroups");
    root.innerHTML = "";

    const reqCount = (customProduct.groups || []).filter(g => g.required).length;
    $("#reqNote").textContent = reqCount ? `Campos obligatorios: ${reqCount}` : "Personaliza a tu gusto.";

    (customProduct.groups || []).forEach(g => {
      const card = document.createElement("div");
      card.className = "opt-card";
      card.innerHTML = `
        <h4>${escapeHtml(g.title)} ${g.required ? "<span style='color:#111; font-weight:950;'>Obligatorio</span>" : "<span style='color:#6b7280;'>Opcional</span>"}</h4>
        <div class="opt-grid" data-group="${escapeHtml(g.id)}"></div>
      `;
      root.appendChild(card);

      const grid = card.querySelector(".opt-grid");
      if(g.type === "radio"){
        g.choices.forEach(ch => {
          const id = `g_${g.id}_${ch.id}`;
          const checked = selections[g.id] === ch.id;
          const el = document.createElement("label");
          el.className = "opt" + (checked ? " is-checked" : "");
          el.innerHTML = `
            <input type="radio" name="${escapeHtml(g.id)}" id="${escapeHtml(id)}" ${checked ? "checked" : ""}>
            <div style="display:flex; gap:10px; align-items:center;">
              ${
                ch.img
                ? `<img src="${ch.img}" alt="${escapeHtml(ch.label)}"
                     style="width:44px;height:44px;border-radius:12px;object-fit:contain;border:1px solid rgba(0,0,0,.08);background:#fff;"
                     onerror="this.style.display='none';">`
                : ``
              }
              <div>
                <div style="font-weight:950;">${escapeHtml(ch.label)}</div>
                <small>${(g.id === "bebida_incluida" && !ch.add) ? "Incluido" : (ch.add ? ("+"+money(ch.add)) : "+S/ 0.00")}</small>
              </div>
            </div>
          `;
          el.addEventListener("click", () => {
            selections[g.id] = ch.id;
            renderCustomGroups();
            updateCustomTotal();
          });
          grid.appendChild(el);
        });
      } else if(g.type === "check"){
        g.choices.forEach(ch => {
          const checked = (selections[g.id] || []).includes(ch.id);
          const el = document.createElement("label");
          el.className = "opt" + (checked ? " is-checked" : "");
          el.innerHTML = `
            <input type="checkbox" ${checked ? "checked" : ""}>
            <div>
              <div style="font-weight:950;">${escapeHtml(ch.label)}</div>
              <small>${(g.id === "bebida_incluida" && !ch.add) ? "Incluido" : (ch.add ? ("+"+money(ch.add)) : "+S/ 0.00")}</small>
            </div>
          `;
          el.addEventListener("click", () => {
            const arr = new Set(selections[g.id] || []);
            if(arr.has(ch.id)) arr.delete(ch.id); else arr.add(ch.id);
            selections[g.id] = [...arr];
            renderCustomGroups();
            updateCustomTotal();
          });
          grid.appendChild(el);
        });
      }
    });
  }

  $("#qtyDec").addEventListener("click", () => {
    customQty = Math.max(1, customQty - 1);
    $("#qtyNum").textContent = String(customQty);
    updateCustomTotal();
  });
  $("#qtyInc").addEventListener("click", () => {
    customQty = Math.min(99, customQty + 1);
    $("#qtyNum").textContent = String(customQty);
    updateCustomTotal();
  });

  function getChoiceById(group, choiceId){
    return (group.choices || []).find(c => c.id === choiceId) || null;
  }

  function calcUnitPrice(){
    let unit = customProduct.price;
    let breakdown = [];

    (customProduct.groups || []).forEach(g => {
      if(g.type === "radio"){
        const pick = selections[g.id];
        if(g.required && !pick){
          selections[g.id] = g.defaultId ?? g.choices?.[0]?.id;
        }
        const ch = getChoiceById(g, selections[g.id]);
        if(ch){
          unit += Number(ch.add || 0);
          breakdown.push(`${g.title}: ${ch.label}${ch.add ? " ("+money(ch.add)+")" : ""}`);
        }
      } else if(g.type === "check"){
        const picks = selections[g.id] || [];
        picks.forEach(pid => {
          const ch = getChoiceById(g, pid);
          if(ch){
            unit += Number(ch.add || 0);
            breakdown.push(`${g.title}: ${ch.label}${ch.add ? " ("+money(ch.add)+")" : ""}`);
          }
        });
      }
    });

    return { unit, breakdown };
  }

  function updateCustomTotal(){
    if(!customProduct) return;
    const { unit, breakdown } = calcUnitPrice();
    const total = unit * customQty;
    $("#customTotal").textContent = money(total);
    $("#customBreakdown").textContent = breakdown.slice(0, 3).join(" ‚Ä¢ ") + (breakdown.length > 3 ? " ‚Ä¢ ..." : "");
  }

  $("#addFromCustom").addEventListener("click", () => {
    if(!customProduct) return;

    const missing = (customProduct.groups || []).filter(g => g.required).some(g => {
      if(g.type === "radio") return !selections[g.id];
      if(g.type === "check") return false;
      return false;
    });
    if(missing){
      alert("Completa las opciones obligatorias.");
      return;
    }

    const { unit } = calcUnitPrice();

    const pretty = [];
    (customProduct.groups || []).forEach(g => {
      if(g.type === "radio"){
        const ch = getChoiceById(g, selections[g.id]);
        if(ch) pretty.push(`${g.title}: ${ch.label}`);
      } else if(g.type === "check"){
        const picks = selections[g.id] || [];
        const names = picks.map(pid => getChoiceById(g,pid)?.label).filter(Boolean);
        if(names.length) pretty.push(`${g.title}: ${names.join(", ")}`);
      }
    });

    const lineName = `${customProduct.name}` + (pretty.length ? ` ‚Ä¢ ${pretty.join(" | ")}` : "");
    const key = customProduct.id + "|" + JSON.stringify(selections);

    addToCartLine({ key, name: lineName, price: unit, qty: customQty });
    closeCustomize();
  });

  // ================== CARRITO MODAL ==================
  function openCart(){
    renderCartModal();
    $("#cartModal").style.display="block";
    $("#cartModal").setAttribute("aria-hidden","false");
  }
  function closeCart(){
    $("#cartModal").style.display="none";
    $("#cartModal").setAttribute("aria-hidden","true");
  }
  $("#openCart").addEventListener("click", openCart);
  // Rese√±as
  $("#openReviews").addEventListener("click", openReviews);
  $("#closeReviews").addEventListener("click", closeReviews);
  $("#reviewsModal").addEventListener("click", (e)=>{ if(e.target.id==="reviewsModal") closeReviews(); });

  $("#closeCart").addEventListener("click", closeCart);
  $("#cartModal").addEventListener("click", (e)=>{ if(e.target.id==="cartModal") closeCart(); });

  $("#clearCart").addEventListener("click", ()=>{ if(confirm("¬øVaciar carrito?")) clearCart(); });

  $("#checkout").addEventListener("click", ()=>{
    const total = cartTotal();
    if(total<=0){ alert("Tu carrito est√° vac√≠o."); return; }
    const items = Object.values(cart).map(i => `‚Ä¢ ${i.qty} x ${i.name} (${money(i.price)})`).join("\n");
    alert(`Pedido (demo)\n\n${items}\n\nTotal: ${money(total)}`);
  });

  function renderCartModal(){
    const root = $("#cartItems");
    root.innerHTML = "";
    const items = Object.values(cart);

    if(items.length === 0){
      root.innerHTML = `<div style="border:1px dashed rgba(0,0,0,.12); border-radius:18px; padding:12px; color:#6b7280; background:#fafafa;">
        Tu carrito est√° vac√≠o. Agrega productos con el bot√≥n "Personalizar".
      </div>`;
      $("#cartTotalText").textContent = money(0);
      return;
    }

    items.forEach(it => {
      const row = document.createElement("div");
      row.style.cssText = "border:1px solid rgba(0,0,0,.10); border-radius:18px; padding:12px; display:flex; justify-content:space-between; gap:10px; align-items:flex-start; box-shadow: 0 10px 18px rgba(17,24,39,.06); background:#fff;";
      row.innerHTML = `
        <div style="min-width:0;">
          <div style="font-weight:950; font-size:14px; margin-bottom:6px;">${escapeHtml(it.name)}</div>
          <div style="color:#6b7280; font-size:13px;">${money(it.price)} c/u</div>
          <div style="color:#6b7280; font-size:13px;"><strong>Subtotal:</strong> ${money(it.price * it.qty)}</div>
        </div>
        <div style="display:flex; align-items:center; gap:8px;">
          <button type="button" data-act="dec" data-id="${escapeHtml(it.id)}" style="width:36px;height:36px;border-radius:14px;border:1px solid rgba(0,0,0,.10);background:#f3f4f6;font-weight:950;cursor:pointer;">‚àí</button>
          <strong style="min-width:18px; text-align:center;">${it.qty}</strong>
          <button type="button" data-act="inc" data-id="${escapeHtml(it.id)}" style="width:36px;height:36px;border-radius:14px;border:1px solid rgba(0,0,0,.10);background:#f3f4f6;font-weight:950;cursor:pointer;">+</button>
        </div>
      `;
      root.appendChild(row);
    });

    $$("#cartItems [data-act]").forEach(btn => {
      btn.addEventListener("click", () => {
        const id = btn.dataset.id;
        const act = btn.dataset.act;
        changeQty(id, act === "inc" ? 1 : -1);
      });
    });

    $("#cartTotalText").textContent = money(cartTotal());
  }
</script>

</body>
</html>
